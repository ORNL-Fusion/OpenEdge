# Plasma parameters

variable T  equal   35*11605.0
variable TeV  equal   35.0
variable n  equal   5e18
variable fnum equal 5e15

variable B equal 2.25  # T
variable Eb equal 8.68 # eV
variable alpha equal 2.0 # degree


########################################### setup                     #####################################################
seed                12345
dimension           3


###########################################  -------------- ###########################################
boundary            r r o
global              gridcut 0.0 comm/sort no
create_box          -0.001 1.1 -0.001 1.1 -0.001 .2
create_grid         3 3 3
balance_grid        rcb  cell

species             plasma.species W W+ W2+ W3+ W4+ W5+ W6+ W7+ W8+
mixture             species W     frac 1    # type 1
mixture             species W+    frac 0. # type 2
mixture             species W2+   frac 0.    # type 3
mixture             species W3+   frac 0.    # type 4
mixture             species W4+   frac 0.    # type 5
mixture             species W5+   frac 0.    # type 6
mixture             species W6+   frac 0.    # type 7
mixture             species W7+   frac 0.    # type 8
mixture             species W8+   frac 0.    # type 9


read_surf           surfaces/flatSurface.txt
surf_collide        1 vanish
surf_modify         all collide 1

##################################--- set atomic processes----###########################################

read_particles particles.dat 0


compute cnear plasma/fields/constant all all magnetic_field 0 0.0 5.3 electric_field 0 0 0 temp_e 22.6 temp_i 22.6 dens_e 1e20 dens_i 1e20 parrflow 1e5 surfid mindist bx by bz ex ey ez temp_e temp_i dens_i dens_e parrflow nesheath

fix Fdist ave/grid all 1 1 1 c_cnear[*]
dump 1 grid all 1 tmp.grid id f_Fdist[*]


# Ionization/Recombination
fix 22 chem/adas 100 74 input/plasma.adas plasma c_cnear[6] c_cnear[9]

## Push particles
fix bB bfield/grid c_cnear[3] c_cnear[4] c_cnear[5]
global bfield grid bB 1

fix Esheath efield/grid c_cnear[11]  c_cnear[12]  c_cnear[13]
global efield grid Esheath 1


#dump 10 particle all 100 state id type x y z vx vy vz

timestep            1e-6
stats               100
stats_style         step cpu  np


run              1 #000 #20000

